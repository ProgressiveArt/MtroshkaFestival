@using Microsoft.ApplicationInsights.AspNetCore.Extensions
@using EnumsNET
@model MetroshkaFestival.Application.Queries.Models.Tournaments.TournamentModel
@{
    ViewData["Title"] = "Профиль турнира";
    ViewData["Controller"] = "Tournament";
    ViewBag.Tab = "tab0";
    ViewBag.TabProfile = "tab0";
    var returnUrl = Context.Request.GetUri().AbsoluteUri;
}

<div class="container mt-4 col-8 rounded pr-4 pl-4 pb-2" enctype="multipart/form-data">
    <div class="text-center p-3 row justify-content-center">
        <span class="h3">@ViewData["Title"]</span><br>
        <button type="button" class="btn btn-outline-dark w-25">
            <a asp-area="Admin" asp-controller="Tournament" asp-action="Index" class="p-0 m-0 text-right nav-link text-decoration-none@(ViewBag.Tab == "tab0" ? "active" : null)" style="font-size: 14px; color: #007fff">Назад к списку</a>
        </button>
    </div>
    <input data-val="true" asp-for="Id" type="hidden" value="@Model?.Id"/>

    <div class="card">
        <div class="card-header text-center">
            <h5 class="card-title bg-gradient">@Model?.Name</h5>
        </div>
        <div class="card-body">
            <dl class="row">
                <dt class="col-sm-3">Год проведения: </dt>
                <dd class="col-sm-9">@Model?.YearOfTour</dd>

                <dt class="col-sm-3">Город проведения: </dt>
                <dd class="col-sm-9">@Model?.City.Name</dd>

                <dt class="col-sm-3">Описание турнира: </dt>
                <dd class="col-sm-9">@Model?.Description</dd>
            </dl>

            <div class="row text-center">
                <a asp-area="Admin" asp-controller="Tournament" asp-action="TournamentSummary" class="btn btn-success mt-2 col-sm w-25"
                   asp-route-tournamentId="@Model.Id" asp-route-isReadOnly="false" asp-route-returnUrl="@returnUrl">
                    Изменить
                </a>
            </div>
        </div>
    </div>
</div>

<nav>
    <div class="nav nav-tabs nav-fill px-2 mt-2" id="nav-tab" role="tablist">
        <button class="nav-link active" id="nav-groups-tab" data-bs-toggle="tab" data-bs-target="#nav-groups" type="button" role="tab" aria-controls="nav-groups" aria-selected="true">Группы</button>
        <button class="nav-link" id="nav-matches-tab" data-bs-toggle="tab" data-bs-target="#nav-matches" type="button" role="tab" aria-controls="nav-matches" aria-selected="false">Контакт</button>
    </div>
</nav>

<div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-groups" role="tabpanel" aria-labelledby="nav-groups-tab">

        <div class="mt-3 mb-2 text-center">
            <a asp-area="Admin" asp-controller="Group" asp-action="GetAddGroupPage" asp-route-returnUrl="@returnUrl" asp-route-tournamentId="@Model.Id" class="btn btn-secondary">Добавить группу</a>
        </div>

        <table class="table table-hover table-bordered">
            <thead class="text-center">
            <tr class="table-active">
                <th scope="col" class="table-dark w-auto">ID</th>
                <th scope="col" class="table-dark w-50">Название</th>
                <th scope="col" class="table-dark w-auto">Возрастная категория</th>
                <th scope="col" class="table-dark w-25">Действие</th>
            </tr>
            </thead>
            @if (Model.Groups.Any())
            {
                <tbody>
                @foreach (var group in Model.Groups)
                {
                    <tr>
                        <th class="text-center">@group.Id</th>
                        <td class="text-center">@group.Name.AsString(EnumFormat.Description)</td>
                        <td class="text-center">@group.AgeCategory.Name</td>
                        <td class="p-1 text-center">
                            <a asp-area="Admin" asp-controller="Group" asp-action="DeleteGroup" asp-route-groupId="@group.Id" asp-route-returnUrl="@returnUrl" class="btn btn-outline-danger btn-md btn-block w-50">Удалить</a>
                        </td>
                    </tr>
                }
                </tbody>
            }

        </table>
    </div>
    <div class="tab-pane fade" id="nav-matches" role="tabpanel" aria-labelledby="nav-matches-tab">йцукйцук</div>
</div>

@section Scripts
{
    <script src="~/js/checkInvalid.js"></script>
}